# ุฅุตูุงุญ ุดุงูู - ุงูููุงุชูุฑ ุงููุงููุฉ ุงูุขู

## ๐ด ุงููุดููุฉ ุงูุชู ุชู ุญููุง

### ุงููุดููุฉ:
**ุงูููุงุชูุฑ ูุงูุช ุบูุฑ ูุงููุฉ** - ุงูุนูุงุตุฑ ูู ุงูููุงุชูุฑ ูุงูุช ุชูุชูุฏ ููุญููู ุงููููุฉ:
- โ ูุง ูุญุชูู `cost` ุฃู `costUSD`
- โ ูุง ูุญุชูู `priceUSD` ุฏุงุฆูุงู
- โ ูุคุฏู ุฅูู ุฃุฑุจุงุญ ุณุงูุจุฉ ุฃู ุบูุฑ ุตุญูุญุฉ
- โ ุชูุงุฑูุฑ ุบูุฑ ุฏูููุฉ

---

## โ ุงูุญููู ุงููููุฐุฉ

### 1๏ธโฃ ุฅุตูุงุญ ุฅูุดุงุก ููุงุชูุฑ ุฌุฏูุฏุฉ (ุงูููุฏูุฉ)
**ุงูููุงู:** `processCashPayment()` ูู script.js

**ูุง ุชู:**
- โ ุฅุถุงูุฉ `cost` ู `costUSD` ููู ุนูุตุฑ ูู ุงูููุชุฌุงุช
- โ ุฅุถุงูุฉ `priceUSD` ููู ุนูุตุฑ
- โ ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุญุตูู ุนูู ุงูุชูููุฉ ุงููุนููุฉ
- โ ุชุณุฌูู ููุตู ููู ุนูุตุฑ

**ุงูููุฏ:**
```javascript
// ุงูุจุญุซ ุนู ุงูููุชุฌ ููุญุตูู ุนูู ุงูุชูููุฉ
const product = products.find(p => p.id === item.id);
const costUSD = product ? (product.costUSD || 0) : 0;

saleItems.push({
    id: item.id,
    name: item.name,
    quantity: item.quantity,
    price: price,
    priceUSD: baseUSD,    // โ ุฅุถุงูุฉ ุงูุณุนุฑ ุจุงูุฏููุงุฑ
    cost: costUSD,        // โ ุฅุถุงูุฉ ุงูุชูููุฉ
    costUSD: costUSD,     // โ ุฅุถุงูุฉ ุงูุชูููุฉ ุจุงูุฏููุงุฑ
    originalPriceUSD: originalUSD,
    finalPriceUSD: baseUSD,
    discountUSD: discountUSD,
    discountPct: discountPct
});
```

---

### 2๏ธโฃ ุฅุตูุงุญ ุฅูุดุงุก ููุงุชูุฑ ุงูุจูุน ุจุงูุฏูู
**ุงูููุงู:** `createCreditSaleInvoice()` ูู script.js

**ูุง ุชู:**
- โ ุฅุถุงูุฉ `cost` ู `costUSD` ููู ุนูุตุฑ
- โ ุฅุถุงูุฉ `priceUSD` ููู ุนูุตุฑ
- โ ููุณ ุงูููุทู ุงููุทุจู ุนูู ุงูููุงุชูุฑ ุงูููุฏูุฉ

---

### 3๏ธโฃ ุฅุตูุงุญ ููุงุชูุฑ ุงูุงุณุชุฑุฌุงุน
**ุงูููุงู:** `processReturn()` ูู script.js

**ูุง ุชู:**
- โ ูุณุฎ `cost` ู `costUSD` ูู ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ
- โ ูุณุฎ `priceUSD` ุฅุฐุง ูุงู ููุฌูุฏุงู
- โ ุงูุญูุงุธ ุนูู ุฌููุน ุงูุจูุงูุงุช ููุงุณุชุฑุฌุงุน

**ุงูููุฏ:**
```javascript
const returnedItems = (currentSaleForReturn.items || []).map(it => ({
    id: it.id,
    name: it.name,
    quantity: Math.max(1, Math.floor((it.quantity || 1) * ratio)),
    price: it.price,
    priceUSD: it.priceUSD || it.price,     // โ ุฅุถุงูุฉ priceUSD
    cost: it.cost || it.costUSD || 0,      // โ ุฅุถุงูุฉ cost
    costUSD: it.costUSD || it.cost || 0,   // โ ุฅุถุงูุฉ costUSD
    originalPriceUSD: it.originalPriceUSD,
    finalPriceUSD: it.finalPriceUSD,
    discountUSD: it.discountUSD,
    discountPct: it.discountPct
}));
```

---

### 4๏ธโฃ ุฅุตูุงุญ ุงูููุงุชูุฑ ุงููุฏููุฉ
**ุงูุฏุงูุฉ ุงูุฌุฏูุฏุฉ:** `fixOldInvoicesMissingFields()`

**ุงูููุฒุงุช:**
- โ ูุญุต ุฌููุน ุงูููุงุชูุฑ ุงููุฏููุฉ
- โ ุฅุถุงูุฉ `cost` ู `costUSD` ุงูููููุฏุฉ
- โ ุฅุถุงูุฉ `priceUSD` ุงูููููุฏุฉ
- โ ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุญูุธ ุชููุงุฆู ููุชุบููุฑุงุช

**ุงูุงุณุชุฎุฏุงู:**
```javascript
// ูู Console (F12):
fixOldInvoicesMissingFields()
```

---

### 5๏ธโฃ ุชุญุฏูุซ recalculateProfitAndFixNegativeValues
**ุงูุชุญุณููุงุช:**
- โ ูุณุชุฏุนู `fixOldInvoicesMissingFields()` ุชููุงุฆูุงู
- โ ูุนูุฏ ุญุณุงุจ ุงูุฃุฑุจุงุญ ุจุดูู ุตุญูุญ
- โ ููุชุดู ุงูููู ุงูุณุงูุจุฉ
- โ ูุนุฑุถ ุชูุฑูุฑ ุดุงูู

---

## ๐ฏ ุงููุชูุฌุฉ

### ูุจู ุงูุฅุตูุงุญ:
```
ูุงุชูุฑุฉ:
{
  id: 1,
  name: "ูููุงูููุง",
  quantity: 2,
  price: 2.00
  // โ ูุง ููุฌุฏ cost!
  // โ ูุง ููุฌุฏ priceUSD!
}
```

### ุจุนุฏ ุงูุฅุตูุงุญ:
```
ูุงุชูุฑุฉ:
{
  id: 1,
  name: "ูููุงูููุง",
  quantity: 2,
  price: 2.00,
  priceUSD: 1.00,      // โ
  cost: 0.50,          // โ
  costUSD: 0.50,       // โ
  originalPriceUSD: 1.00,
  finalPriceUSD: 1.00,
  discountUSD: 0,
  discountPct: 0
}
```

---

## ๐ ุงูุชุดุบูู ุงูุชููุงุฆู

### ุนูุฏ ุชุญููู ุงูุตูุญุฉ:
1. โ **ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุงูููููุฏุฉ** - `recalculateProfitAndFixNegativeValues()`
2. โ **ุฅุตูุงุญ timestamps** - `fixOldSalesTimestamps()`
3. โ **ุฅุตูุงุญ ุงูุญููู ุงููุงูุตุฉ** - `fixOldInvoicesMissingFields()`
4. โ **ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุฃุฑุจุงุญ** - ุชููุงุฆูุงู

### ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ:
- โ **ุญูุธ ุชููุงุฆู** ูุฌููุน ุงูุญููู ุงููุทููุจุฉ
- โ **ูุณุฎ ุงุญุชูุงุทู** ูุจู ุงูุญูุธ
- โ **ุชุณุฌูู ููุตู** ูู Console

---

## ๐๏ธ ุงูุงุณุชุฎุฏุงู ุงููุฏูู

### ูู Console (F12):
```javascript
// ุฅุตูุงุญ ุงูููุงุชูุฑ ุงููุฏููุฉ
fixOldInvoicesMissingFields()

// ุฅุตูุงุญ ุดุงูู
recalculateProfitAndFixNegativeValues()
```

---

## ๐ ุงูุญููู ุงููุทููุจุฉ ูู ูู ูุงุชูุฑุฉ

### ุงูุญููู ุงูุฃุณุงุณูุฉ:
- โ `id` - ูุนุฑู ุงูููุชุฌ
- โ `name` - ุงุณู ุงูููุชุฌ
- โ `quantity` - ุงููููุฉ
- โ `price` - ุงูุณุนุฑ (ุจุงูุนููุฉ ุงููุญุฏุฏุฉ)
- โ `priceUSD` - ุงูุณุนุฑ ุจุงูุฏููุงุฑ
- โ `cost` - ุงูุชูููุฉ
- โ `costUSD` - ุงูุชูููุฉ ุจุงูุฏููุงุฑ

### ุงูุญููู ุงูุฅุถุงููุฉ:
- โ `originalPriceUSD` - ุงูุณุนุฑ ุงูุฃุตูู
- โ `finalPriceUSD` - ุงูุณุนุฑ ุงูููุงุฆู
- โ `discountUSD` - ุงูุฎุตู ุจุงูุฏููุงุฑ
- โ `discountPct` - ูุณุจุฉ ุงูุฎุตู

---

## ๐ ุงูููุงุฆุฏ

### ููุญุณุงุจุงุช:
- โ **ุฃุฑุจุงุญ ุฏูููุฉ 100%**
- โ **ูุง ูุฒูุฏ ูู ุงูููู ุงูุณุงูุจุฉ**
- โ **ุญุณุงุจ ุตุญูุญ ููุฑุจุญ ุงูุตุงูู**

### ููุชูุงุฑูุฑ:
- โ **ุชูุงุฑูุฑ ุฏูููุฉ**
- โ **ุชูุงููู ุตุญูุญุฉ**
- โ **ุฃุฑุจุงุญ ูุญุณูุจุฉ ุจุดูู ุตุญูุญ**

### ููุจูุงูุงุช:
- โ **ููุงุชูุฑ ูุงููุฉ**
- โ **ุฌููุน ุงูุญููู ูุชููุฑุฉ**
- โ **ูุณุฎ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ**

---

## ๐ ุชุณุฌูู ููุตู

### ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ:
```
๐ ุนูุตุฑ ูููุงุชูุฑุฉ: ูููุงูููุง - ุงูุณุนุฑ: $1.00, ุงูุชูููุฉ: $0.50
๐ ุนูุตุฑ ูููุงุชูุฑุฉ: ุฎุจุฒ - ุงูุณุนุฑ: $0.50, ุงูุชูููุฉ: $0.25
โ ุชู ุญูุธ sales ุจูุฌุงุญ (1234 ุญุฑู)
```

### ุนูุฏ ุฅุตูุงุญ ููุงุชูุฑ ูุฏููุฉ:
```
โ ุชู ุฅุตูุงุญ ูุงุชูุฑุฉ INV-001
โ ุชู ุฅุตูุงุญ ูุงุชูุฑุฉ INV-002
๐ ุชู ุฅุตูุงุญ 25 ูู ุงูููุงุชูุฑ!
```

---

## ๐ ุงูุชุญูู ูู ุงูููุงุชูุฑ

### ูู Console (F12):
```javascript
// ุนุฑุถ ูุงุชูุฑุฉ ูุญุฏุฏุฉ
const sale = JSON.parse(localStorage.getItem('sales'));
console.log(sale[0]); // ุนุฑุถ ุฃูู ูุงุชูุฑุฉ

// ูุญุต ุนูุตุฑ ูุญุฏุฏ
console.log(sale[0].items[0]); // ุนุฑุถ ุฃูู ุนูุตุฑ ูู ุงููุงุชูุฑุฉ

// ุงูุชุญูู ูู ูุฌูุฏ ุงูุญููู ุงููุทููุจุฉ
const item = sale[0].items[0];
console.log({
    hasCost: item.cost !== undefined,
    hasCostUSD: item.costUSD !== undefined,
    hasPriceUSD: item.priceUSD !== undefined
});
```

---

## โ ููุฎุต ุงูุฅุตูุงุญุงุช

| ุงููุดููุฉ | ุงูุญู | ุงููุชูุฌุฉ |
|---------|------|---------|
| โ ููุงุชูุฑ ูุงูุตุฉ | โ ุฅุถุงูุฉ cost ู priceUSD | ููุงุชูุฑ ูุงููุฉ |
| โ ุฃุฑุจุงุญ ุณุงูุจุฉ | โ ุฅุนุงุฏุฉ ุญุณุงุจ ุตุญูุญ | ุฃุฑุจุงุญ ุฏูููุฉ |
| โ ุชูุงุฑูุฑ ุฎุงุทุฆุฉ | โ ุจูุงูุงุช ูุงููุฉ | ุชูุงุฑูุฑ ุตุญูุญุฉ |
| โ ููุงุชูุฑ ูุฏููุฉ | โ ุฅุตูุงุญ ุชููุงุฆู | ุฌููุน ุงูููุงุชูุฑ ุตุญูุญุฉ |

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ุงููุธุงู ุงูุขู:
โ **ููุงุชูุฑ ูุงููุฉ 100%**  
โ **ุฌููุน ุงูุญููู ูุชููุฑุฉ**  
โ **ุฃุฑุจุงุญ ุฏูููุฉ**  
โ **ุชูุงุฑูุฑ ุตุญูุญุฉ**  
โ **ุฅุตูุงุญ ุชููุงุฆู**  

---

**ุชู ุจูุฌุงุญ! ๐**

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** ุงูููู  
**ุงูุฅุตุฏุงุฑ:** ุงูุฅุตุฏุงุฑ ุงูุญุงูู  
**ุงูููุทูุฉ ุงูุฒูููุฉ:** Asia/Beirut

