# ๐ด ุฅุตูุงุญ ุญุฑุฌ - ุงุฎุชูุงุก ุงูููุงุชูุฑ ุจุนุฏ ุงูุณุงุนุฉ 6:30 ูุณุงุกู

## ๐ด ุงููุดููุฉ ุงูุฃุตููุฉ

**ุงูุฃุนุฑุงุถ:**
- ุงูููุงุชูุฑ ุชุฎุชูู ูู ุงูุณุฌู ุจุนุฏ ุงูุณุงุนุฉ 6:30 ูุณุงุกู
- ุงูุฃุฑุจุงุญ ุชุตุจุญ ุตูุฑ ุฃู ุณุงูุจุฉ
- ุงูุชูุงุฑูุฑ ุชููุฏ ุงูุจูุงูุงุช

**ุงูุณุจุจ ุงูุฌุฐุฑู:**
ุงุณุชุฎุฏุงู `toISOString()` ูุญูู ุงูููุช ุฅูู UTCุ ูุนูุฏ ุงูุณุงุนุฉ 6:30 ูุณุงุกู ุจุชูููุช ุจูุฑูุช (UTC+3):
- 18:30 ุจูุฑูุช = 15:30 UTC
- ุงูููุงุชุฑ ุงูุชู ุชุณุชุฎุฏู UTC ุชููุฏ ุงููุจูุนุงุช!

---

## โ ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ

### 1๏ธโฃ ุงุณุชุจุฏุงู ุฌููุน ุงุณุชุฎุฏุงูุงุช toISOString()

**ุงุณุชุจุฏุงู ุจู:**
- `getLocalDateTimeISO()` - ููููุช ุงููุญูู ุงููุงูู
- `getLocalDateString()` - ููุชุงุฑูุฎ ููุท

**ุชู ุฅุตูุงุญ:**
- โ `cashDrawer.lastUpdate`
- โ `cashDrawer.transactions`
- โ `stockMovements` timestamps
- โ `customer.creditHistory`
- โ ุฌููุน transactions

### 2๏ธโฃ ุชูุญูุฏ ุฏูุงู ุงูุชูููุช

**ุงูุฏูุงู ุงูููุญุฏุฉ:**
```javascript
parseLocalDate()       // ุชุญููู ุฃู ุชุงุฑูุฎ ุจุดูู ุตุญูุญ
getStartOfLocalDay()   // ุจุฏุงูุฉ ุงูููู 00:00:00
getEndOfLocalDay()     // ููุงูุฉ ุงูููู 23:59:59
isSaleInDateRange()    // ูุญุต ุงููุทุงู
isSaleOnDate()         // ูุญุต ุงูุชุงุฑูุฎ ุจุงูุถุจุท
```

### 3๏ธโฃ ุฅุตูุงุญ getRangeByPreset()

**ูุจู:**
```javascript
from.setHours(0,0,0,0);   // โ UTC conversion issues
to.setHours(23,59,59,999); // โ UTC conversion issues
```

**ุจุนุฏ:**
```javascript
from = getStartOfLocalDay(now);  // โ ูุญูู ุฏุงุฆูุงู
to = getEndOfLocalDay(now);      // โ ูุญูู ุฏุงุฆูุงู
```

### 4๏ธโฃ ูุธุงู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููุญุณูู

**ุงูููุฒุงุช:**
- โ ูุณุฎ ูุจู ูู ุชุญุฏูุซ
- โ ุงูุงุญุชูุงุธ ุจุฃุญุฏุซ 5 ูุณุฎ
- โ ุงุณุชุนุงุฏุฉ ุชููุงุฆูุฉ ุนูุฏ ุงููุดู

### 5๏ธโฃ ุฅุตูุงุญ ุงูููุงุชูุฑ ุงููุฏููุฉ

**ุงูุฏุงูุฉ:** `fixOldInvoicesMissingFields()`
- โ ุฅุถุงูุฉ `cost` ู `costUSD` ุงูููููุฏุฉ
- โ ุฅุถุงูุฉ `priceUSD` ุงูููููุฏุฉ
- โ ุงุณุชุฑุฌุงุน ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐จ ุฅุตูุงุญ ููุฑู ููุจูุงูุงุช ุงูุญุงููุฉ

### ุงูุฎุทูุฉ 1: ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช

ุงูุชุญ Console (F12) ูุงูุชุจ:

```javascript
// 1. ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุงูููููุฏุฉ
recoverMissingData()

// 2. ุฅุตูุงุญ ุงูููุงุชูุฑ ุงููุฏููุฉ
fixOldInvoicesMissingFields()

// 3. ุฅุตูุงุญ ุดุงูู
recalculateProfitAndFixNegativeValues()

// 4. ุฅุนุงุฏุฉ ุงูุชุญููู
location.reload()
```

### ุงูุฎุทูุฉ 2: ุงูุชุญูู

```javascript
// ุนุฑุถ ุฌููุน ุงูููุงุชูุฑ
const allSales = JSON.parse(localStorage.getItem('sales'));
console.log(`ุนุฏุฏ ุงูููุงุชูุฑ: ${allSales.length}`);

// ุนุฑุถ ููุงุชูุฑ ุงูููู
const today = getLocalDateString();
const todaySales = allSales.filter(s => {
    const d = parseLocalDate(s.timestamp || s.date);
    return d && getLocalDateString(d) === today;
});
console.log(`ููุงุชูุฑ ุงูููู: ${todaySales.length}`);
```

---

## โ ูุง ุชู ููุนู ุงูุขู

### โ ูุจู ุงูุฅุตูุงุญ:
- `new Date().toISOString()` โ 18:30 ุจูุฑูุช = 15:30 UTC
- ุงูุชุญููู ูุบูุฑ ุงูุชุงุฑูุฎ ุจุนุฏ 6:30 ูุณุงุกู
- ุงูููุงุชูุฑ ุชุนุชุจุฑ "ุบุฏุงู" ูู UTC
- ุงูููุงุชุฑ ุชููุฏ ุงููุจูุนุงุช

### โ ุจุนุฏ ุงูุฅุตูุงุญ:
- `getLocalDateTimeISO()` โ 18:30 ุจูุฑูุช = 18:30 ุจูุฑูุช
- ูุง ุชุญููู UTC ุฃุจุฏุงู
- ููุณ ุงูุชูููุช ูู ูู ุงูุญุณุงุจุงุช
- ุงูููุงุชุฑ ุชุนูู ุจุดูู ุตุญูุญ

---

## ๐ฏ ุงูุญู ุงููุงูู

### 1. ุชุซุจูุช ุงูููุทูุฉ ุงูุฒูููุฉ
- โ ุงุณุชุฎุฏุงู `getLocalDateTimeISO()` ูู ูู ููุงู
- โ ุงุณุชุฎุฏุงู `parseLocalDate()` ูุชุญููู ุงูุชูุงุฑูุฎ
- โ ุงุณุชุฎุฏุงู `isSaleOnDate()` ููููุชุฑุฉ

### 2. ุฅููุงู ุนูููุงุช ุงููุณุญ
- โ ูุง ููุฌุฏ `localStorage.clear()` ุชููุงุฆู
- โ ูุง ููุฌุฏ reset ููุจูุงูุงุช
- โ ุงููุณุฎ ุงูุงุญุชูุงุทู ูุญูู ูู ุงูุฃุฎุทุงุก

### 3. ุญูุธ ุขูู
- โ ูุณุฎ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ
- โ ุงุณุชุนุงุฏุฉ ุนูุฏ ุงููุดู
- โ ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

---

## ๐ ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงูุณุงุนุฉ 6:30 ูุณุงุกู:

ุงูุชุญ Console (F12) ูู ุงูุณุงุนุฉ 6:30 ูุณุงุกู ูุงูุชุจ:

```javascript
// ุฅูุดุงุก ุจูุน ุชุฌุฑูุจู
const now = new Date();
console.log('ุงูุชูููุช ุงูุญุงูู:', now.toLocaleString('ar-LB'));

// ุงูุชุญูู ูู ุงูููุชุฑุฉ
const today = getLocalDateString();
const start = getStartOfLocalDay();
const end = getEndOfLocalDay();

console.log('ุงูููู:', today);
console.log('ุงููุทุงู:', start.toLocaleString('ar-LB'), 'ุฅูู', end.toLocaleString('ar-LB'));

// ูุญุต ุงููุจูุนุงุช
const sales = JSON.parse(localStorage.getItem('sales'));
const todaySales = sales.filter(s => isSaleOnDate(s, new Date()));
console.log(`ููุงุชูุฑ ุงูููู: ${todaySales.length}`);
```

---

## ๐ ุงูุชุดุฎูุต

### ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:

**1. ูุญุต localStorage:**
```javascript
console.log('ุญุฌู sales:', JSON.parse(localStorage.getItem('sales')).length);
console.log('ุขุฎุฑ ุญูู:', Object.keys(localStorage));
```

**2. ูุญุต ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:**
```javascript
const backups = Object.keys(localStorage).filter(k => k.startsWith('backup_sales_'));
console.log('ุนุฏุฏ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ:', backups.length);
console.log('ุขุฎุฑ ูุณุฎุฉ:', backups.sort().pop());
```

**3. ูุญุต ุงูุชูููุช:**
```javascript
const testSale = JSON.parse(localStorage.getItem('sales'))[0];
console.log('Timestamp:', testSale.timestamp);
console.log('Parsed:', parseLocalDate(testSale.timestamp));
console.log('Is today:', isSaleOnDate(testSale, new Date()));
```

---

## ๐ ูููุงุช ุงูุฅุตูุงุญ

1. **CRITICAL_6_30PM_FIX.md** (ูุฐุง ุงูููู) - ุงูุฅุตูุงุญ ุงูุญุฑุฌุฉ
2. **INVOICES_COMPLETE_FIX.md** - ุฅุตูุงุญ ุงูููุงุชูุฑ
3. **DATA_RECOVERY_SYSTEM.md** - ุงููุณุฎ ุงูุงุญุชูุงุทู
4. **ุงูููุฎุต_ุงูููุงุฆู_ููุฅุตูุงุญุงุช.md** - ููุฎุต ุดุงูู

---

## ๐ ุงููุชูุฌุฉ

### ุงูุขู:
โ **ูุง ูุฒูุฏ ูู ุงุฎุชูุงุก ุงูููุงุชูุฑ**  
โ **ุงูุชูููุช ุซุงุจุช ุนูู Asia/Beirut**  
โ **ูุณุฎ ุงุญุชูุงุทูุฉ ุชููุงุฆูุฉ**  
โ **ุงุณุชุนุงุฏุฉ ุนูุฏ ุงููุดู**  
โ **ููุงุชูุฑ ูุงููุฉ**  

### ุงูุงูุชุญุงู:
ุงูุชุญ ุงููุธุงู ูู **6:30 ูุณุงุกู** ูุชุฃูุฏ:
- โ ุงูููุงุชูุฑ ุชุธูุฑ
- โ ุงูุฃุฑุจุงุญ ุตุญูุญุฉ
- โ ุงูุชูุงุฑูุฑ ุฏูููุฉ

---

**ุชู ุจูุฌุงุญ! ๐**

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** ุงูููู  
**ุงูููุทูุฉ ุงูุฒูููุฉ:** Asia/Beirut (ุซุงุจุชุฉ ุฏุงุฆูุงู)

